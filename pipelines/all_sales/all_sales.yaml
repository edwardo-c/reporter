# plans passed into plan executor for capturing all sales and importing in persistent duck db

load:
  - op: "xlsx_reader"
    args:
      file_cfgs:
        - alias: "all_direct_2025"
          path: ${INCENTIVE_COMP}
          sheet_name: "All Direct"
          header: 5
          usecols: 
            - "Account"
            - "Customer Name"
            - "Inventory CD"
            - "Qty"
            - "Amount"
            - "Classification(Sales Category)"
            - "Invoice Date"
          rename_map:
            "Account": "acct_num"
            "Customer Name": "cust_name"
            "Inventory CD": "part_number"
            "Qty": "qty"
            "Amount": "amount"
            "Classification(Sales Category)": "product_category"
            "Invoice Date": "invoice_date"

        - alias: "pos_2025"
          path: ${INCENTIVE_COMP}
          sheet_name: "POS"
          header: 5
          usecols:
            - "Customer"
            - "SoldToName"
            - "PiiPartNumber"
            - "ShipQuantity"
            - "ExtendedSales"
            - "PiiCategory"
            - "PeriodDate"
          rename_map:
            "Customer": "distributor"
            "SoldToName": "cust_name"
            "PiiPartNumber": "part_number"
            "ShipQuantity": "qty"
            "ExtendedSales": "amount"
            "PiiCategory": "product_category"
            "PeriodDate": "invoice_date"
  - op: "stack_frames"
    args:
      schema:
        - "distributor"
        - "acct_num"
        - "cust_name"
        - "part_number"
        - "qty"
        - "amount"
        - "product_category"
        - "invoice_date"
      