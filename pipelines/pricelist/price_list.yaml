imports:
  all:
  - op: 'dir_to_csv'
    args:
      dir: ${PRICE_GROUPS_DIR}
  - op: 'archive'
    args:
      dir: ${PRICE_GROUPS_ARCHIVE_DIR}

plans:
  shade:
    - op: filter
      args:
        col: Price Group
        val: SHADE
        case_insensitive: true
        filter_in: true # keep only those with SHADE
  
  non_shade:
    - op: filter
      args:
        col: Price Group
        val: SHADE
        case_insensitive: true
        filter_in: False # keep all except SHADE
  
  all:
    - op: groupby
      args:
        by: Customer
        dropna: true

exports:
  - from: shade
    using: csv
    args:
      path: "${SHADE_CSV_DIR}/{acct_num}.csv"
      index: false
  
  - from: non_shade
    using: csv
    args:
      path: "${NON_SHADE_CSV_DIR}/{acct_num}.csv"
      index: false