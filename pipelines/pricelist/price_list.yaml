load:
  - op: 'dir_to_df'
    args:
      cfg:
        directory: ${PRICE_GROUPS_DIR}
        recursive: false
        suffixes: .csv
        add_source: false

plans:
  shade:
    - op: filter
      args:
        col: "Price Group"
        val: SHADE
        case_insensitive: true
        filter_in: true # keep only those with SHADE
    - op: drop_null_dups
      args:
        null_col: "Customer Price Class"
        keep_null: true
        subset: ["Customer", "Part Number"]

  non_shade:
    - op: filter
      args:
        col: "Price Group"
        val: SHADE
        case_insensitive: true
        filter_in: false # keep all except SHADE

exports:
  shade:
    - op: csv_partitioned
      args:
        partition_by: "Customer"
        root_dir: ${SHADE_CSV_DIR}
        dry_run: false
  
  non_shade:
    - op: csv_partitioned
      args:  
        partition_by: "Customer"
        root_dir: ${SHADE_CSV_DIR}
        dry_run: false