load:
  - op: 'dir_to_df'
    args:
      cfg:
        directory: ${PRICE_GROUPS_DIR}
        recursive: false
        suffixes: .csv
        add_source: false

plans:
  shade:
    - op: filter
      args:
        col: "Price Group"
        val: SHADE
        case_insensitive: true
        filter_in: true # keep only those with SHADE
  
  non_shade:
    - op: filter
      args:
        col: Price Group
        val: SHADE
        case_insensitive: true
        filter_in: false # keep all except SHADE

exports:
  - from: shade
    using: csv
    args:
      path: "${SHADE_CSV_DIR}/{acct_num}.csv"
      index: false
  
  - from: non_shade
    using: csv
    args:
      path: "${NON_SHADE_CSV_DIR}/{acct_num}.csv"
      index: false